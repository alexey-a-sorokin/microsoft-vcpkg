diff --git a/CMakeLists.txt b/CMakeLists.txt
index 13330ea..d5fcf9d 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -42,8 +42,12 @@ macro_ensure_out_of_source_build("${PROJECT_NAME} requires an out of source buil
 set(CMAKE_LIBRARY_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/lib")
 
 # search for libraries
+set(PC_LIBS_PRIVATE "")
+set(PC_REQUIRES_PRIVATE "")
+
 if (WITH_ZLIB)
     find_package(ZLIB REQUIRED)
+    string(APPEND PC_REQUIRES_PRIVATE "zlib")
 endif (WITH_ZLIB)
 
 if (WITH_GCRYPT)
@@ -53,6 +57,7 @@ elseif(WITH_MBEDTLS)
     find_package(MbedTLS REQUIRED)
 else()
   find_package(OpenSSL 1.1.1 REQUIRED)
+  string(APPEND PC_REQUIRES_PRIVATE " libcrypto")
 endif()
 
 if (UNIT_TESTING)
@@ -63,6 +68,9 @@ endif ()
 set(CMAKE_THREAD_PREFER_PTHREADS ON)
 set(THREADS_PREFER_PTHREAD_FLAG ON)
 find_package(Threads)
+if(Threads_FOUND)
+  string(APPEND PC_LIBS_PRIVATE " ${CMAKE_THREAD_LIBS_INIT}")
+endif()
 
 if (WITH_GSSAPI)
     find_package(GSSAPI)
@@ -96,7 +104,6 @@ add_subdirectory(include)
 add_subdirectory(src)
 
 # pkg-config file
-if (UNIX OR MINGW)
 configure_file(libssh.pc.cmake ${CMAKE_CURRENT_BINARY_DIR}/libssh.pc @ONLY)
 install(
   FILES
@@ -106,7 +113,6 @@ install(
   COMPONENT
     pkgconfig
 )
-endif (UNIX OR MINGW)
 
 # CMake config files
 include(CMakePackageConfigHelpers)
diff --git a/libssh.pc.cmake b/libssh.pc.cmake
index f288b94..759525c 100644
--- a/libssh.pc.cmake
+++ b/libssh.pc.cmake
@@ -7,4 +7,6 @@ Name: @PROJECT_NAME@
 Description: The SSH Library
 Version: @PROJECT_VERSION@
 Libs: -L${libdir} -lssh
+Libs.private: @PC_LIBS_PRIVATE@
+Requires.private: @PC_REQUIRES_PRIVATE@
 Cflags: -I${includedir}
diff --git a/src/CMakeLists.txt b/src/CMakeLists.txt
index 199acbd..2ec00c6 100644
--- a/src/CMakeLists.txt
+++ b/src/CMakeLists.txt
@@ -77,6 +77,8 @@ if (WIN32)
     iphlpapi
     ws2_32
   )
+  string(APPEND PC_LIBS_PRIVATE " -liphlpapi -lws2_32 -lshell32 -ladvapi32")
+  set(PC_LIBS_PRIVATE "${PC_LIBS_PRIVATE}" PARENT_SCOPE)
 endif (WIN32)
 
 if (BUILD_STATIC_LIB)
